<!DOCTYPE html>
<html>
<head>
    <% include ./head.html %>
    <title>Siri-b Petition</title>
</head>
<body>

    <!-- Navigation -->
    <% include ./navigation.html %>
    <style media = "all and (min-width: 769px)">
       .mylink { font-size: 1.9rem; color: #003c70; margin: 0 0.7rem; padding: 0 0.95rem 0.55rem 0.95rem; border-bottom: 0.25rem solid #003c70; }
       .mylink:hover { color: #003c70; padding: 0 1.2rem 0.35rem 1.2rem; border-bottom: 0.25rem solid #003c70; text-decoration:none;}
       .mylink:active { color: #003c70; padding: 0 1.2rem 0.35rem 1.2rem; border-bottom: 0.25rem solid #003c70; text-decoration:none;}
       .mynolink { font-size: 1.9rem; color: #9a9a9a; margin: 0 0.7rem; padding: 0 0.95rem 0.52rem 0.95rem; }
       .mynolink:hover { color: #003c70; padding: 0 1.2rem 0.35rem 1.2rem; border-bottom: 0.25rem solid #003c70; text-decoration:none;}
       .mynolink:active { color: #003c70; padding: 0 1.2rem 0.35rem 1.2rem; border-bottom: 0.25rem solid #003c70; text-decoration:none;}
       .apost {font-size: 1.6rem; padding: 0.8rem 1.2rem; border: 0.16rem solid #dedede; font-weight: bold; color: #dedede;}
       .apost:hover { padding-right: 2.1rem; color: #bcbcbc; text-decoration:none;}
       .apost:active { padding-right: 2.1rem; color: #bcbcbc; text-decoration:none; }
       .myhead { margin: 2.347em 0; font-size:3.5rem;}
       .myhead-text{font-size:3.3rem;}
       .myhead-subtext{font-size:2.5rem;}
       .masthead-text{font-size:2.7rem;}
       .masthead-subtext{font-size:1.8rem;}
   </style>
   <style media = "all and (max-width: 768px)">
       .mylink { font-size: 1.9rem; color: #003c70; padding: 0 0.95rem 0.55rem 0.95rem;}
       .mynolink { font-size: 1.2rem; color: #9a9a9a; padding: 0 0.95rem 0.52rem 0.95rem; }

       .apost {font-size: 1.0rem; padding: 0.8rem 1.2rem; border: 0.16rem solid #dedede; font-weight: bold; color: #dedede;}
       .apost:hover { padding-right: 2.1rem; color: #bcbcbc; text-decoration:none;}
       .apost:active { padding-right: 2.1rem; color: #bcbcbc; text-decoration:none; }
       .myhead { margin: 2.8em 0 1.8em 0;font-size:3rem;}
       .myhead-text{font-size:2.5rem;}
       .myhead-subtext{font-size:2rem;}
       .masthead-text{font-size:1.8rem;}
       .masthead-subtext{font-size:1.0rem;}
   </style>

   <div class="myhead">
       <h1 class="myhead-subtext" align="center">My Page</h1>
   </div>

    <div class="container">
    <h3>나의 청원</h3>
    <hr>


    <div class="my_petitions">
        <li type="disc">나의 청원 : <a class="text-primary" href="/users/mypage?view=all"><%=info.all_cnt%>건</a></li>
        <li type="disc">진행 중인 청원 : <a class="text-primary" href="/users/mypage?view=ing"><%=info.ing_cnt%>건</a></li>
        <li type="disc">답변된 청원 : <a class="text-primary" href="/users/mypage?view=answered"><%=info.answered_cnt%>건</a></li>
    </div>
    <hr>

    <table class="table table-hover" style="text-align:center;" cellspacing="0.6rem">
        <tr style="border-top: 0.2rem solid #003c70;">
            <th style="font-size: 1.2rem; padding: 0.9rem 0.28rem; background-color: #003c70; color: #ffffff" scope="col">번호</th>
            <th style="font-size: 1.2rem; padding: 0.9rem 0.28rem; background-color: #003c70; color: #ffffff" scope="col">분류</th>
            <th style="font-size: 1.2rem; padding: 0.9rem 0.28rem; background-color: #003c70; color: #ffffff" scope="col">제목</th>
            <th style="font-size: 1.2rem; padding: 0.9rem 0.28rem; background-color: #003c70; color: #ffffff" scope="col">기간</th>
            <th style="font-size: 1.2rem; padding: 0.9rem 0.28rem; background-color: #003c70; color: #ffffff" scope="col">참여인원</th>
            <th style="font-size: 1.2rem; padding: 0.9rem 0.28rem; background-color: #003c70; color: #ffffff" scope="col">상태</th>
        </tr>

        <% var n=info.no; %>
        <% var i=n;%>
        <%if(n>0) {%>
            <% contents.forEach(function(item) {%>

            <tr style="font-size: 1rem" class="table-light">
                <td class="table-text"><strong><%=i%></td>
                <td class="table-text"><strong class="text-primary"><%=item.type%></td>
                <%if(item.title.length >= 38) {%>
                    <%var txt = "";%>
                    <%for(var j = 0; j < 38; j++) {%>
                        <%txt += item.title[j];%>
                    <%}%>
                    <%txt += "...";%>
                <td class="table-text"><strong class="text-muted"><a href='/petition/content?id=<%=item._id%>'><%=txt%></td>
                    <%}else {%>
                        <td class="table-text"><strong class="text-muted"><a href='/petition/content?id=<%=item._id%>'><%=item.title%></td>
                    <%}%>
                <td class="table-text"><strong><%=item.startDay%>~<%=item.endDay%></td>
                <%if(item.count>=20) {%>
                    <td class="table-text"><strong class="text-primary"><%=item.count%></td>
                <%} else {%>
                    <td class="table-text"><strong class="text-muted"><%=item.count%></td>
                <%}%>

                <%if(item.endDay<Date.now) {%>
                    <%if (item.count>=20) {%>
                        <td class="table-text"><strong>답변대기</td>
                    <%} else {%>
                        <td class="table-text"><strong>진행중</td>
                    <%}%>
                <%} else if (item.answer_flag) {%>
                    <td class="table-text"><strong>답변완료</td>
                <%}else if(!item.answer_flag) {%>
                    <td class="table-text"><strong>답변대기</td>
                <%} else {%>
                    <td class="table-text"><strong>기간만료</td>
                <%}%>
            </tr>
            <%i=i-1;%>
            <%});%>
        <%} else {%>
            작성한 글이 없습니다.
            <%}%>

    </table>

    <form action="/users/mypage" method="get" style="width:40% justify-content: center;">
        <input type="hidden" name="sort" value="<%=info.sort%>">
        <input type="hidden" name="deadlineFlag" value="<%=info.deadlineFlag%>">
        <input type="hidden" name="type" value="search">
        <input type="hidden" name="view" value="<%=info.view%>">
        <% var placeholder;%>
        <%if (info.view=="all") {%>
        <% placeholder="나의 청원";%>
        <%}else if(info.view=="ing") {%>
        <% placeholder="진행 중인 청원";%>
        <%} else {%>
        <% placeholder="답변된 청원";%>
        <%}%>
        <input class="form-control mr-sm-2" type="text" placeholder="<%=placeholder%> 검색하기" name="word" style="display: inline-block; width:60%;">
        <div style="display: inline-block; width:20%;">
            <button class="btn btn-secondary btn-xs" type="submit">Search</button>
        </div>
    </form>
    <hr>

    <div class="container border-light mb-5" style="max-width: 22rem;">
        <ul class="pagination" style="justify-content: center;">
            <%if(info.active==1) {%>
                <li class="page-item disabled">
                    <a class="page-link" href="/users/mypage?page=1&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&laquo;</a>
                </li>
            <%} else {%>
                <li class="page-item">
                    <a class="page-link " href="/users/mypage?page=1&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&laquo;</a>
                </li>
            <%}%>
            <%if(info.startPage==1) {%>
                <li class="page-item disabled">
                    <a class="page-link" href="/users/mypage?page=<%=info.startPage-info.limitPage%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&lt;</a>
                </li>
            <%} else {%>
                <li class="page-item">
                    <a class="page-link" href="/users/mypage?page=<%=info.startPage-info.limitPage%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&lt;</a>
                </li>
            <%}%>
            <%for(var i=info.startPage; i<=info.endPage; i++){%>
                <%if(i==info.active) {%>
                    <li class="page-item active">
                        <a class="page-link" href="/users/mypage?page=<%=i%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>"><%=i%></a>
                    </li>
                <%} else {%>
                    <li class="page-item">
                        <a class="page-link" href="/users/mypage?page=<%=i%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>"><%=i%></a>
                    </li>
                <%}%>
            <%}%>
            <%if(info.endPage==info.pagination) {%>
                <li class="page-item disabled">
                    <a class="page-link" href="/users/mypage?page=<%=info.startPage-(-info.limitPage)%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&gt;</a>
                </li>
            <%} else {%>
                <li class="page-item">
                    <a class="page-link" href="/users/mypage?page=<%=info.startPage-(-info.limitPage)%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&gt;</a>
                </li>
            <%}%>
            <%if(info.active==info.pagination) {%>
                <li class="page-item disabled">
                    <a class="page-link" href="/users/mypage?page=<%=info.pagination%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&raquo;</a>
                </li>
            <%} else {%>
                <li class="page-item">
                    <a class="page-link " href="/users/mypage?page=<%=info.pagination%>&sort=<%=info.sort%>&type=<%=info.type%>&view=<%=info.view%>&word=<%=info.word%>&deadlineFlag=<%=info.deadlineFlag%>">&raquo;</a>
                </li>
            <%}%>
        </ul>
    </div>
</div>

</body>
</html>
